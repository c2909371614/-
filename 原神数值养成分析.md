

# 原神数值养成分析

前言：

​	该文档的目标：通过对角色基础属性的进行**数值分配** (*数值之间有约束条件有公式*) 计算出**不同定位角色**在**特定的环境**下使得其在**5min**的时间内的**伤害值**达到**最大**

​	需要考虑到的问题：

​									1.如何进行元素属性的搭配 (元素属性有：雷、火、冰、水、风、岩. 即选择那几个元素反应作为输出补充)

​									2.选择哪一属性为主C

​									3.队伍是需要物理输出还是元素输出

​									4.是否需要频繁切换角色(队伍里有4个角色，角色只能在场一个)

### 一、基本设定介绍

##### 1、冒险等级

<center>表 1   冒险等级介绍</center>

![](冒险等级介绍.png)

##### 2、体力系统

​                                                  图 1 为什么原神会让人想氪金

 ![](为什么原神会让人氪.png)

##### 3、角色培养

<center>经验花费随角色等级变化表

![](F:\机器人学院资料\Python_practice\原神数值计算器\经验花费随角色等级变化表.png)



<center>图 2 经验花费随角色等级变化

![](经验花费随角色等级变化图.png)

### 二、基础属性

- 生命（HP）
- 攻击力(ATK)
- 防御力(DEF)
- 元素精通(ELemental Mastery)
- 体力(Max Stamina)
- 暴击率(crit rate )
- 暴击伤害(critical damage)
- 治疗加成
- 元素充能(Elemental Enegy)
- 元素伤害加成(Elemental damage addition) 
- 物理伤害加成(Physical damage addition)
- 其他辅助功能

#### 1.属性分类

​	**伤害属性**

​		攻击力、暴击伤害、暴击率、元素伤害加成、元素充能、元素精通

​	**防御属性**

​		生命值、防御力、体力

​	**辅助属性**

​		治疗加成、元素精通、元素充能、其他辅助功能

#### 2.角色定位

​	**主C角色**：队伍的主要伤害提供点. 尽可能提高**伤害属性**.

​	**副C角色**：队伍第二强力输出点. 当主C角色还未成型时，可以作为补充输出的点. 可以选择 **伤害+其他**（具体搭配需要按角色、现有武器、刷到的圣遗物、现有升					  级材料而定) 

​	**辅助角色**：一般为挂元素的工具角色或者具有为其他角色进行伤害属性或直接伤害加成，或者有聚怪的能力，例如：温蒂、砂糖. 尽量选择**辅助属性**，聚怪角色  					   尽可能提高元素精通(因为风属性能够同时发生多种元素反应造成巨额元素反应伤害)

​	**奶妈/爸角色**：具有群体回血(回复生命值)的角色. 一般尽量提高奶量加成属性(不同的角色奶量计算公式不同)

#### 3.伤害分类

​	**物理伤害**：一般为弓箭角色、长枪、单手剑双手剑角色，代表角色：主C雷泽、主C皇女(非谢尔)、副C七七

​	**元素伤害**：一般为法典角色、弓箭角色、大剑角色、单手剑，代表角色：主C可莉、主C凝光、主C卢老爷(迪卢克)、主C公子、主C刻晴、副C皇女)

​	**元素反应伤害**：超载、感电、超导、融化、蒸发、冰冻、结晶、扩散

<center>图 3 元素反应关系 

<img src="Elemental_Reaction.jpg" style="zoom:70%;" />

<center>图 4  剧变反应随等级变化曲线

![](元素反应倍率.jpg)

**伤害比例**：超导 : 扩散 : 碎冰 : 超载 : 感电 = 1 : 1.2 : 3 : 4 : 4.8

**sp：**

​		感电会造成二次伤害

​		超载会产生AOE和爆炸

​		碎冰会解除冰冻效果

​		超导会降低目标40%物理防御

​		扩散产生的元素结晶最多

​		结晶提供护盾和元素充能

**增幅反应**

​	水--火：2.0

​	火--水：1.5

​	火--冰：2.0

​	冰--火：1.5

#### 4.武器分类

<center>表2 武器类别和武器属性类别


| 武器\属性加成 类别 | 攻击力+暴击| 攻击力+爆伤 | 攻击力+被伤 | 攻击力+元充 | 攻击力+元精  | 攻击力+物伤+回复 | 攻击力+生命 |
| :-----------: | :--: |:--:| :--: | :--: | :-----------: | :-----------: | :-----------: |
| 双手剑         |      |      | 古华 | 祭礼 | | | |
| 单手剑         |      |      | | 祭礼、西风 | | 风鹰 | |
| 长枪 |      |      |      | | | | |
| 弓箭 |      |      |      | | | | |
| 法典 | 四风 |      |      | | 万国图、祭礼 | | 讨龙 |

#### 5.圣遗物分类

<center>表3 圣遗物套装类别和属性类别


| 套装\属性 | 套装描述 | 攻击力(ATK) | 暴击(CR) | 爆伤(CD) | 元伤(EDA) | 元充 | 元精 | 生命(HP) | 防御(DEF) |
| --------- | ------ | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 角斗 | 加攻击力和近战角色普攻伤害 |        |      |      |      |      |      |      |      |
| 乐团 | 加元素精通和远程角色普攻伤害 |        |      |      |      |      |      |      |      |
| 宗室 | 加元素爆发和全体属性加成 |        |      |      |      |      |      |      |      |
| 火套(魔女) | 加火属性伤害和火类元素反应伤害 | | | | | | | | |
| 雷套(雷怒) | 加雷属性伤害和火类元素反应伤害 | | | | | | | | |
| 风套(翠绿) | 加风属性伤害和火类元素反应伤害 | | | | | | | | |
| 岩套(古岩) | 加岩伤和护盾状态时的元素伤害 | | | | | | | | |
| 染血 | 物理伤害加成，击杀敌人后重击伤害加成 | | | | | | | | |



### 三、伤害计算公式

#### 1.物理伤害

​	伤害期望
$$
S_物=ATK*(1+CR*CD)*(1+PDA)
$$
​	ATK为攻击力，S为伤害，CR为暴击率，CD为暴击额外伤害，PDA为物理伤害加成

#### 2.元素伤害

​	伤害期望
$$
S_元=ATK*(1+CR*CD)*(1+EDA)
$$
​	EDA为元素伤害加成

#### 3.元素反应伤害

​	                                                       图 5 元素精通对元素反应具有加成

​	![](元素精通.png)

### 四、圣遗物属性分析

- 攻击力(ATK)
- 暴击率(Crit Rate )
- 暴击伤害(Critical Damage)
- 元素伤害加成(Elemental Damage Addition) 
- 物理伤害加成(Physical damage addition)
- 元素精通(Elemental Mastery)
- 生命（HP）
- 治疗加成
- 元素充能(Elemental Energy)
- 防御力(DEF)

##### 1.圣遗物属性分为1个主属性4条副属性

<center>表4 五星圣遗物+20主属性和+0副属性</center>

|     属性类别     |  主属性   |
| :--------------: | :-------: |
|    攻击力/ATK    | 311/46.6% |
|    暴击率/CR     |   31.1%   |
|   暴击伤害/CD    |   62.2%   |
| 元素伤害加成/EDA |   46.6%   |
| 物理伤害加成/PDA |   58.3%   |
|   元素精通/EM    |    187    |
|   元素充能/EE    |   51.8%   |
|    生命值/HP     |   4780    |
|    防御力/DEF    |   58.3%   |

<center>表5 +20五星圣遗物副属性磁条



| ATK  | ATK_1  | CR     | CD     | EM   | EE     | HP   | HP_1  | DEF  | DEF_1  |
| ---- | ------ | ------ | ------ | ---- | ------ | ---- | ----- | ---- | ------ |
|      | 11.10% | 7.00%  |        |      | 9.70%  | 478  |       |      |        |
|      | 9.30%  |        |        |      |        | 418  |       | 42   | 11.70% |
|      | 13.40% |        |        |      |        | 299  | 5.80% |      | 19.70% |
| 18   | 15.70% |        |        | 40   |        |      |       |      | 13.10% |
| 37   |        |        | 12.40% |      | 9.70%  | 538  |       |      |        |
| 53   |        |        |        | 42   | 17.50% |      |       | 23   |        |
| 19   |        | 13.60% | 14.80% |      | 11.00% |      |       |      |        |
|      | 5.30%  |        |        | 21   | 28.50% | 508  |       |      |        |
| 64   |        | 11.70% |        | 47   |        | 239  |       |      |        |

**圣遗物分为花、羽、沙、杯、冠**

花：主磁条必为生命值，无需考虑主属性

羽：主磁条必为攻击力，无需考虑主属性

沙：主磁条为攻击力、元素精通

杯：主磁条为攻击力、元素伤害加成

冠：主磁条为攻击力、暴击率、暴击伤害、元素精通

<center>图 6 四、五星圣遗物主属性强满

![五星、四星圣遗物满强主属性](F:\机器人学院资料\Python_practice\原神数值计算器\五星、四星圣遗物满强主属性.png)

<center>图 7 五星圣遗物培养花费

![image-20201214183517980](F:\机器人学院资料\Python_practice\原神数值计算器\圣遗物经验.png)

<center>图 8 圣遗物培养花费和等级关系图

![](资源对比.jpeg)

1-5星 圣遗物提供的经验：$420, 840, 1260, 2520, 3780$

每天捡圣遗物：$25000-30000$

40体力奖励：$2\times 3780+4\times 2520 + 8\times 1260 = $27720

以+10五星圣遗物为例:

强化后经验  :  强化前经验  :   $(61169-3780):(64075) \approx0.896$

**code 1: 圣遗物分析代码**

```python
#coding = utf-8
#author = cpx
#creating time = 2020.12.14

in_exps = (0,3000,3728,4422,5150,5900,6675,7500,8350,9225,10125, \
	11050,12025,13025,15150,17600,20375,23500,27050,31050,35575)#五星圣遗物1-20级需要的强化经验
money = in_exps#原神圣遗物强化经验和强化金币需求相同
out_exps = (420,840,1260,2520,3780)#1-5星圣遗物作为强化材料的提供的经验
attributes_main_max = {# +20圣遗物主属性磁条
	'ATK' : 0.466,#攻击力
	'CR' : 0.311,#暴击率
	'CD' : 0.622,#暴击伤害
	'EDA' : 0.466,#元素伤害加成
	'PDA' : 0.583#物理伤害加成
}
attributes_main_min = {# +0圣遗物主属性磁条
	'ATK' : 0.07,#攻击力
	'CR' : 0.047,#暴击率
	'CD' : 0.093,#暴击伤害
	'EDA' : 0.07,#元素伤害加成
	'PDA' : 0.079#物理伤害加成
}
add_exps = [0]*len(in_exps)

#------对in_exp做前缀和得到累积经验-----
for i in range(len(in_exps) - 1):
	add_exps[i+1] = add_exps[i] + in_exps[i+1]

#------计算每级圣遗物主属性增长量----
attributes_main_add = attributes_main_min.copy()#创建初始化
for temp in attributes_main_min.keys():
	attributes_main_add[temp] = (attributes_main_max[temp] - attributes_main_min[temp]) / 20

#------计算各等级圣遗物主属性磁条-----
attributes_main = attributes_main_min.copy()
i = 0
for key in attributes_main.keys():
	attributes_main[key] = [0]*21#初始化长度
	attributes_main[key][0] = attributes_main_min[key]
	for j in range(20):
		attributes_main[key][j+1] = round(attributes_main_min[key] + attributes_main_add[key] * (j+1),3)		
grade = range(21)
```

**code 2： 图像绘制**

```python
#coding = utf-8
#author = cpx
#creating time = 2020.12.14

from matplotlib.font_manager import FontProperties#设置显示中文
import matplotlib.pyplot as plt
import Relics_Attribute_Analysis as Relics_Data #将圣遗物分析代码作为类导入使用

add_exps = Relics_Data.add_exps
grade = Relics_Data.grade
attributes_main = Relics_Data.attributes_main.copy()
for key in attributes_main.keys():
	print(key,attributes_main[key])

font = FontProperties(fname=r"simsun.ttf", size=14)  # ""里面为字体的相对地址 或者绝对地址
f,ax1 = plt.subplots()
ax1.plot(grade, add_exps,color = 'red',label = 'exp')
ax1.set_ylim([0, add_exps[len(add_exps)-1]])
ax1.set_xlim([0, 20])
ax1.set_ylabel(u'金币和圣遗物经验(思念)', fontproperties='SimHei') 
ax2 = ax1.twinx() # 创建第二个坐标轴
# print(attributes_main['ATK'])
ax2.plot(grade,attributes_main['ATK'],label = 'ATK')
ax2.plot(grade, attributes_main['CR'], label = 'CR')
ax2.plot(grade, attributes_main['CD'], label = 'CD')
ax2.set_ylim([0, 0.7])
ax1.set_xlabel(u'等级', fontproperties='SimHei') #设置x轴名称 x label
ax2.set_ylabel(u'数值百分比', fontproperties='SimHei') #设置y轴名称 y label
ax2.set_title(u'原神资源与数值关系对比', fontproperties='SimHei') #设置图名为Simple Plot
ax1.legend(loc = 'center left')
ax2.legend(loc = 'best')

plt.show()
# plt.savefig(fname = '原神资源与数值关系对比.png', figsize = [255,255])
```



### 五、武器属性分析

***sp:*** *不考虑武器被动效果，只分析武器基本属性*

<center>表6 常用80级未突破1精炼武器属性



|                | 攻击力    | 暴击率 | 暴击伤害 | 物理伤害 | 元素充能 | 元素精通 |
| -------------- | --------- | ------ | -------- | -------- | -------- | -------- |
| 狼的末路(五星) | 532+65.3% |        |          |          |          |          |
| 试做古华       | 497+25.1% |        |          |          |          |          |
| 风鹰剑(五星)   | 590+20%   |        |          | 37.7%    |          |          |
| 祭礼单手剑     | 401       |        |          |          | 55.9%    |          |
| 祭礼双手剑     | 497       |        |          |          | 27.5%    |          |
| 西风弓         | 401       |        |          |          | 55.9%    |          |
| 西风大剑       | 401       |        |          |          | 55.9%    |          |
| 西风剑         |           |        |          |          |          |          |
| 绝弦弓         | 449       |        |          |          |          | 151      |
| 万国图谱       | 497       |        |          |          |          | 101      |
| 流浪乐章       | 449       |        | 50.3%    |          |          |          |
| 祭礼法典       | 401       |        |          |          |          | 201      |
| 四风原典       | 532       | 30.2%  |          |          |          |          |

### 六、角色属性数值约束条件推导

#### 1.圣遗物属性约束分析

**假设**：为了推导简化，只考虑+20五星圣遗物的属性

+20的圣遗物主属性磁条都是固定数值，可以先分析副属性，再根据花、羽、沙、杯、冠的主属性选择加入到约束中即可

圣遗物在+4 、+8、+12、+16、+20时会随机对其中一个副属性进行加成

根据表5中的信息我们需要推导出10个副属性之间的约束条件，空白的表示为零

圣遗物副属性有10个属性**X = [ATK,  ATK_1,  CR,  CD,  EM,  EE,  HP,  HP_1,  DEF,  DEF_1]**

10个属性满足：
$$
sum(X./A) = 9
$$
其中
$$
A=[a_{ATK},  a_{ATK\_1},  a_{CR},  a_{CD},  a_{EM},  a_{EE},  a_{HP},  a_{HP\_1},  a_{DEF},  a_{DEF\_1}]
$$
表示对应属性每次强化时增加的大小

由于数据中空缺数据较多直接拟合造成一下结果

**code 3： 圣遗物副属性约束分析**

```python
import numpy as np
import pandas as pd
from sklearn.linear_model import LinearRegression

RelicsData = pd.read_excel('圣遗物副属性.xlsx')
RelicsData.fillna(0, inplace=True )
features = ['ATK', 'ATK_1', 'CR', 'CD', 'EM', 'EE', 'HP', 'HP_1', 'DEF', 'DEF_1']
# print(features[:10])
X_train = RelicsData[features]
len_X = len(X_train)
Y_train = np.ones((len_X,), dtype = np.int)*4
# X_train.info()
linreg = LinearRegression()
linreg.fit(X_train,Y_train)
y_predict = linreg.predict(X_train)
# print(linreg.score(X_train, Y_train))
print(linreg.coef_, linreg.intercept_)
```

结果:
```python
A = [0 0 0 0 0 0 0 0 0 0] 截距=4.0
```

**code 4： 上面代码改量(将截距设置为零)**

```python
import numpy as np
import pandas as pd
from sklearn.linear_model import LinearRegression

RelicsData = pd.read_excel('圣遗物副属性.xlsx')
RelicsData.fillna(0, inplace=True )
features = ['ATK', 'ATK_1', 'CR', 'CD', 'EM', 'EE', 'HP', 'HP_1', 'DEF', 'DEF_1']
# print(features[:10])
X_train = RelicsData[features]
len_X = len(X_train)
Y_train = np.ones((len_X,), dtype = np.int)*4
# X_train.info()
linreg = LinearRegression(fit_intercept = False)#将截距设置为0
linreg.fit(X_train,Y_train)
y_predict = linreg.predict(X_train)
print(linreg.score(X_train, Y_train))
print(linreg.coef_, '截距:%.3f' %linreg.intercept_)
```

得到一下结果

~~~python
A=[2.78246314e-02 1.65053149e+01 8.87584962e+00 1.05442944e+01
 1.52892833e-02 6.39391423e+00 1.93598324e-03 1.31545587e+01
 3.31416855e-02 2.26286026e+00] 截距:0.000
~~~

**与实际相差很大，均不合理**

### 七、人物分析

**分类**：

双手剑角色：攻速：1下/秒

单手剑角色：攻速：2下/秒

弓箭角色：攻速：2下/秒

以作者角色属性为例，进行人物面板强度分析，不考虑角色天赋影响 (*被动的属性加成由于直接体现在面板中，所以考虑*)

$E=ATK*(1+CR*CD)*(1+DA)$

DA 伤害加成 (主元素伤害的元素伤增计算，物理的用物伤增计算) ，E为预期伤害

**code 5: 人物面板强度简单计算代码实现**

~~~python
# -*- coding: utf-8 -*-
#@author: cpx
#creating time = 2020.12.13

ATK = float(input('输入攻击力：'))
CR = float(input('输入暴击率：'))
CD = float(input('输入暴击伤害：'))
EDA = float(input('输入伤害加成：'))
E_S = ATK*(1+CR*CD)*(1+EDA)
print('预期伤害：%.2f' %E_S)
~~~



#### 1.迪卢克(卢老爷，卢锅巴)

(1) 平时

<div  align=left> <img src="原神角色数值\image-20201215004931960.png" alt="image-20201215004931960" style="zoom:200%;" /></div> 

(2) 开大

 <img src="原神角色数值\image-20201215013145906.png" alt="image-20201215013145906" style="zoom:200%;" />

(3)爆发

 <img src="原神角色数值\image-20201215013353242.png" alt="image-20201215013353242" style="zoom:200%;" />

#### 2.七七


$$
\begin{align}
 ATK&:3529 \\
 CR&:0.104 \\
 CD&:0.500 \\
 DA&:0.395 \\
 预期伤害&：5178.95 \\
\end{align}
$$


#### 3.非谢尔(皇女)

 <img src="原神角色数值\image-20201215005833607.png" alt="image-20201215005833607" style="zoom:200%;" />

#### 4.雷泽

  <img src="原神角色数值\image-20201215020359417.png" alt="image-20201215020359417" style="zoom:200%;" />

带古话

 <img src="原神角色数值\image-20201215024057598.png" alt="image-20201215024057598" style="zoom:200%;" />

#### 5.行秋

 <img src="原神角色数值\image-20201215012510285.png" alt="image-20201215012510285" style="zoom:200%;" />

#### 6.岩主

 <img src="原神角色数值\image-20201215012637824.png" alt="image-20201215012637824" style="zoom:200%;" />